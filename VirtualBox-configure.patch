--- configure.orig	2007-08-23 21:34:25.000000000 +0200
+++ configure	2007-08-23 21:39:54.000000000 +0200
@@ -57,7 +57,6 @@
 CFLAGSHAL="-I/usr/include/hal -I/usr/include/dbus-1.0 -I/usr/lib/dbus-1.0/include"
 LIBPATHHAL=""
 LIBHAL="-lhal -ldbus-1"
-QTDIR="/usr/qt/3 /usr/lib/qt3 /usr/lib/qt-3.3 /usr/share/qt3 /usr/lib64/qt-3.3"
 KBUILDDIR="`cd $(dirname $0); pwd`/kBuild"
 DEVDIR="`cd $(dirname $0); pwd`/tools"
 if [ -d /lib/modules/`uname -r`/build ]; then
@@ -167,8 +166,8 @@
   echo "compiling the following source file:" >> $LOG
   cat .tmp_src.cc >> $LOG
   echo "using the following command line:" >> $LOG
-  echo "$CXX -O -Wall -o .tmp_out .tmp_src.cc \"$1\"" >> $LOG
-  $CXX -O -Wall -o .tmp_out .tmp_src.cc $1 >> $LOG 2>&1
+  echo "$CXX -O -Wall -o .tmp_out .tmp_src.cc -L/usr/X11R6/lib \"$1\"" >> $LOG
+  $CXX -O -Wall -o .tmp_out .tmp_src.cc -L/usr/X11R6/lib $1 >> $LOG 2>&1
   if (($?!=0)); then
     if [ -z "$4" ]; then
       echo -e "\n  $2 not found at $1 or $3 headers not found"
@@ -873,37 +872,26 @@
 }
 ' > .tmp_src.cc
   found_qt=0
-  libs="lib"
-  [ "$LIB" = "lib64" ] && libs="$libs lib64"
-  for q in $QTDIR; do
-    for l in $libs; do
-      echo "compiling the following source file:" >> $LOG
-      cat .tmp_src.cc >> $LOG
-      echo "using the following command line:" >> $LOG
-      echo "$CXX -O -Wall -o .tmp_out .tmp_src.cc -I$q/include -L$q/$l -lqt-mt" >> $LOG
+  echo "compiling the following source file:" >> $LOG
+  cat .tmp_src.cc >> $LOG
+  echo "using the following command line:" >> $LOG
+  echo "$CXX -O -Wall -o .tmp_out .tmp_src.cc -I/usr/include/qt -L/usr/lib -lqt-mt" >> $LOG
     
-      $CXX -O -Wall -o .tmp_out .tmp_src.cc -I$q/include -L$q/$l -lqt-mt >> $LOG 2>&1
-      if (($?==0)); then
-        if test_execute; then
-          cnf_append "QTDIR" "`cd $q ; pwd`"
-          found_qt=1
-          break
-        fi
-      fi
-    done
-    if (($found_qt==1)); then
-      break
+  $CXX -O -Wall -o .tmp_out .tmp_src.cc -I/usr/include/qt -L/usr/lib -lqt-mt >> $LOG 2>&1
+  if (($?==0)); then
+    if test_execute; then
+      found_qt=1
     fi
-  done
+  fi
   if (($found_qt!=1)); then
-    echo -e "\n  Qt not found at \"$QTDIR\" or Qt headers not found"
+    echo -e "\n  Qt not found or Qt headers not found"
     echo      "  Check the file $LOG for detailed error information."
     fail
     return 1
   fi
   test_header "Qt devtools"
-  if check_avail "$q/bin/moc" QTDIR/bin; then
-    moc_ver=`$q/bin/moc 2>&1 -v|sed 's+^.*(Qt \(.*\))+\1+'`
+  if check_avail "/usr/bin/moc"; then
+    moc_ver=`/usr/bin/moc 2>&1 -v|sed 's+^.*(Qt \(.*\))+\1+'`
     if (($?!=0)); then
       log_failure "not found"
       fail
@@ -1081,7 +1069,6 @@
   --with-hal=LIB          location of the libhal libraries [$LIBHAL]
   --with-linux=DIR        Linux kernel source directory [$LINUX]
   --with-mkisofs=PATH     location of mkisofs [$MKISOFS]
-  --with-qt-dir=DIR       directory for QT headers/libraries [$QTDIR]
   --with-xalan=LIB        location of the xalan library [$LIBXALAN]
   --with-xerces=LIB       location of the xerces library [$LIBXERCES]
 
@@ -1118,9 +1105,6 @@
         exit 1
       fi
       ;;
-    --with-qt-dir=*)
-      QTDIR=`echo $option | cut -d'=' -f2`
-      ;;
     --with-hal-dir=*)
       INCHAL=`echo $option | cut -d'=' -f2`
       ;;
